[2025-10-10 10:13:45] [INFO] [main:50] Starting subtitle correction...
[2025-10-10 10:13:45] [INFO] [provider:37] OpenAIProvider chat called for model: google/gemini-2.5-pro
[2025-10-10 10:13:45] [INFO] [provider:55] Sending request to API (attempt 1/3, non-streaming mode)...
[2025-10-10 10:13:45] [ERROR] [provider:181] Unexpected error during OpenAI API call (attempt 1/3): 'OpenaiProvider' object has no attribute 'client'
[2025-10-10 10:13:45] [INFO] [provider:183] Retrying in 5 seconds...
[2025-10-10 10:13:50] [INFO] [provider:55] Sending request to API (attempt 2/3, non-streaming mode)...
[2025-10-10 10:13:50] [ERROR] [provider:181] Unexpected error during OpenAI API call (attempt 2/3): 'OpenaiProvider' object has no attribute 'client'
[2025-10-10 10:13:50] [INFO] [provider:183] Retrying in 5 seconds...
[2025-10-10 10:13:55] [INFO] [provider:55] Sending request to API (attempt 3/3, non-streaming mode)...
[2025-10-10 10:13:55] [ERROR] [provider:181] Unexpected error during OpenAI API call (attempt 3/3): 'OpenaiProvider' object has no attribute 'client'
[2025-10-10 10:13:55] [ERROR] [main:58] 字幕校正失败: None
[2025-10-10 10:15:28] [INFO] [main:50] Starting subtitle correction...
[2025-10-10 10:15:28] [INFO] [provider:38] OpenAIProvider chat called for model: google/gemini-2.5-pro
[2025-10-10 10:15:28] [INFO] [provider:56] Sending request to API (attempt 1/3, non-streaming mode)...
[2025-10-10 10:16:46] [ERROR] [provider:182] Unexpected error during OpenAI API call (attempt 1/3): Expecting value: line 369 column 1 (char 2024)
[2025-10-10 10:16:46] [INFO] [provider:184] Retrying in 5 seconds...
[2025-10-10 10:16:51] [INFO] [provider:56] Sending request to API (attempt 2/3, non-streaming mode)...
[2025-10-10 10:19:22] [INFO] [main:50] Starting subtitle correction...
[2025-10-10 10:19:22] [ERROR] [main:79] 程序执行过程中发生错误: BaseSubtitleStrategy.process() missing 1 required positional argument: 'text'
[2025-10-10 10:19:34] [INFO] [main:50] Starting subtitle correction...
[2025-10-10 10:19:34] [INFO] [provider:38] OpenAIProvider chat called for model: google/gemini-2.5-pro
[2025-10-10 10:19:34] [INFO] [provider:56] Sending request to API (attempt 1/3, non-streaming mode)...
[2025-10-10 10:20:19] [ERROR] [provider:182] Unexpected error during OpenAI API call (attempt 1/3): Expecting value: line 215 column 1 (char 1177)
[2025-10-10 10:20:19] [INFO] [provider:184] Retrying in 5 seconds...
[2025-10-10 10:20:24] [INFO] [provider:56] Sending request to API (attempt 2/3, non-streaming mode)...
[2025-10-10 10:28:54] [INFO] [provider:67] Received response from API
[2025-10-10 10:28:54] [INFO] [provider:83] Response: finish_reason=stop, content_length=51444 chars
[2025-10-10 10:28:54] [INFO] [main:54] 字幕校正成功，内容长度: 51444
[2025-10-10 10:28:54] [INFO] [main:56] 校正结果已保存到: test_mode/PRED-726-uncensored-nyap2p.com.corrected.srt
[2025-10-10 10:28:54] [INFO] [main:61] Starting subtitle translation...
[2025-10-10 10:28:54] [INFO] [provider:38] OpenAIProvider chat called for model: google/gemini-2.5-pro
[2025-10-10 10:28:54] [INFO] [provider:56] Sending request to API (attempt 1/3, non-streaming mode)...
[2025-10-10 12:05:22] [INFO] [main:52] ================================================================================
[2025-10-10 12:05:22] [INFO] [main:53] 开始字幕校正...
[2025-10-10 12:05:22] [INFO] [main:54] ================================================================================
[2025-10-10 12:05:22] [INFO] [strategies:205] Processing node with 1598 subtitles
[2025-10-10 12:05:22] [INFO] [provider:42] OpenAIProvider chat called for model: google/gemini-2.5-pro
[2025-10-10 12:05:22] [INFO] [provider:61] Sending request to API (attempt 1/3, non-streaming mode)...
[2025-10-10 12:06:12] [ERROR] [provider:202] Unexpected error during OpenAI API call (attempt 1/3): Expecting value: line 233 column 1 (char 1276)
[2025-10-10 12:06:12] [INFO] [provider:204] Retrying in 5 seconds...
[2025-10-10 12:06:17] [INFO] [provider:61] Sending request to API (attempt 2/3, non-streaming mode)...
[2025-10-10 12:11:05] [ERROR] [provider:202] Unexpected error during OpenAI API call (attempt 2/3): Expecting value: line 1367 column 1 (char 7513)
[2025-10-10 12:11:05] [INFO] [provider:204] Retrying in 5 seconds...
[2025-10-10 12:11:10] [INFO] [provider:61] Sending request to API (attempt 3/3, non-streaming mode)...
[2025-10-10 12:20:51] [INFO] [main:52] ================================================================================
[2025-10-10 12:20:51] [INFO] [main:53] 开始字幕校正...
[2025-10-10 12:20:51] [INFO] [main:54] ================================================================================
[2025-10-10 12:20:51] [INFO] [strategies:205] Processing node with 1598 subtitles
[2025-10-10 12:20:51] [INFO] [provider:42] OpenAIProvider chat called for model: google/gemini-2.5-pro
[2025-10-10 12:20:51] [INFO] [provider:61] Sending request to API (attempt 1/5, non-streaming mode)...
[2025-10-10 12:27:45] [ERROR] [provider:202] Unexpected error during OpenAI API call (attempt 1/5): Expecting value: line 1965 column 1 (char 10802)
[2025-10-10 12:27:45] [INFO] [provider:204] Retrying in 8 seconds...
[2025-10-10 12:27:53] [INFO] [provider:61] Sending request to API (attempt 2/5, non-streaming mode)...
[2025-10-10 12:31:21] [ERROR] [provider:202] Unexpected error during OpenAI API call (attempt 2/5): Expecting value: line 981 column 1 (char 5390)
[2025-10-10 12:31:21] [INFO] [provider:204] Retrying in 8 seconds...
[2025-10-10 12:31:29] [INFO] [provider:61] Sending request to API (attempt 3/5, non-streaming mode)...
[2025-10-10 12:32:36] [ERROR] [provider:202] Unexpected error during OpenAI API call (attempt 3/5): Expecting value: line 319 column 1 (char 1749)
[2025-10-10 12:32:36] [INFO] [provider:204] Retrying in 8 seconds...
[2025-10-10 12:32:44] [INFO] [provider:61] Sending request to API (attempt 4/5, non-streaming mode)...
[2025-10-10 13:02:13] [INFO] [main:52] ================================================================================
[2025-10-10 13:02:13] [INFO] [main:53] 开始字幕校正...
[2025-10-10 13:02:13] [INFO] [main:54] ================================================================================
[2025-10-10 13:02:13] [INFO] [strategies:205] Processing node with 1598 subtitles
[2025-10-10 13:02:13] [INFO] [provider:42] OpenAIProvider chat called for model: google/gemini-2.5-pro
[2025-10-10 13:02:13] [INFO] [provider:61] Sending request to API (attempt 1/5, non-streaming mode)...
[2025-10-10 13:08:47] [INFO] [provider:72] Received response from API
[2025-10-10 13:08:47] [INFO] [provider:89] Response: finish_reason=stop, content_length=52406 chars
[2025-10-10 13:08:47] [INFO] [strategies:216] Node processed successfully
[2025-10-10 13:08:47] [INFO] [main:60] ✓ 字幕校正成功
[2025-10-10 13:08:47] [INFO] [main:61]   - 内容长度: 45687 字符
[2025-10-10 13:08:47] [INFO] [main:62]   - API 调用次数: 1
[2025-10-10 13:08:47] [INFO] [main:63]   - 总耗时: 393842 毫秒 (393.84 秒)
[2025-10-10 13:08:47] [ERROR] [main:80] 无法解析 JSON 结果: Extra data: line 2 column 1 (char 2)
[2025-10-10 13:19:11] [INFO] [main:52] ================================================================================
[2025-10-10 13:19:11] [INFO] [main:53] 开始字幕校正...
[2025-10-10 13:19:11] [INFO] [main:54] ================================================================================
[2025-10-10 13:19:11] [INFO] [strategies:205] Processing node with 1598 subtitles
[2025-10-10 13:19:11] [INFO] [provider:42] OpenAIProvider chat called for model: google/gemini-2.5-pro
[2025-10-10 13:19:11] [INFO] [provider:61] Sending request to API (attempt 1/5, non-streaming mode)...
[2025-10-10 13:19:13] [ERROR] [provider:192] OpenAI API status error (attempt 1/5): 402 - {"error":{"message":"Insufficient credits. Add more using https://openrouter.ai/settings/credits","code":402}}
[2025-10-10 13:19:13] [INFO] [provider:194] Status code 402 is retryable. Retrying in 8 seconds...
[2025-10-10 13:19:21] [INFO] [provider:61] Sending request to API (attempt 2/5, non-streaming mode)...
[2025-10-10 13:19:22] [ERROR] [provider:192] OpenAI API status error (attempt 2/5): 402 - {"error":{"message":"Insufficient credits. Add more using https://openrouter.ai/settings/credits","code":402}}
[2025-10-10 13:19:22] [INFO] [provider:194] Status code 402 is retryable. Retrying in 8 seconds...
[2025-10-10 13:25:24] [INFO] [main:52] ================================================================================
[2025-10-10 13:25:24] [INFO] [main:53] 开始字幕校正...
[2025-10-10 13:25:24] [INFO] [main:54] ================================================================================
[2025-10-10 13:25:24] [INFO] [strategies:205] Processing node with 1598 subtitles
[2025-10-10 13:25:24] [INFO] [provider:42] OpenAIProvider chat called for model: google/gemini-2.5-pro
[2025-10-10 13:25:24] [INFO] [provider:61] Sending request to API (attempt 1/5, non-streaming mode)...
[2025-10-10 13:34:14] [INFO] [provider:72] Received response from API
[2025-10-10 13:34:14] [INFO] [provider:89] Response: finish_reason=stop, content_length=66502 chars
[2025-10-10 13:34:14] [INFO] [strategies:216] Node processed successfully
[2025-10-10 13:34:14] [INFO] [main:60] ✓ 字幕校正成功
[2025-10-10 13:34:14] [INFO] [main:61]   - 内容长度: 59178 字符
[2025-10-10 13:34:14] [INFO] [main:62]   - API 调用次数: 1
[2025-10-10 13:34:14] [INFO] [main:63]   - 总耗时: 530254 毫秒 (530.25 秒)
[2025-10-10 13:34:14] [INFO] [main:70]   - 原始响应已保存到: test_mode/PRED-726-corrected-raw.txt
[2025-10-10 13:34:14] [WARNING] [main:76] 标准JSON解析失败: Extra data: line 2 column 1 (char 2)，尝试提取第一个有效JSON对象...
[2025-10-10 13:34:14] [INFO] [main:80]   - 成功提取JSON对象（位置0-1），忽略了后续59177个字符
[2025-10-10 13:34:14] [ERROR] [main:156] 程序执行过程中发生错误: 'int' object has no attribute 'get'
[2025-10-10 13:35:34] [INFO] [main:52] ================================================================================
[2025-10-10 13:35:34] [INFO] [main:53] 开始字幕校正...
[2025-10-10 13:35:34] [INFO] [main:54] ================================================================================
[2025-10-10 13:35:34] [INFO] [strategies:205] Processing node with 1598 subtitles
[2025-10-10 13:35:34] [INFO] [provider:42] OpenAIProvider chat called for model: google/gemini-2.5-pro
[2025-10-10 13:35:34] [INFO] [provider:61] Sending request to API (attempt 1/5, non-streaming mode)...
[2025-10-10 13:42:45] [INFO] [provider:72] Received response from API
[2025-10-10 13:42:45] [INFO] [provider:89] Response: finish_reason=stop, content_length=52396 chars
[2025-10-10 13:42:45] [INFO] [strategies:216] Node processed successfully
[2025-10-10 13:42:45] [INFO] [main:60] ✓ 字幕校正成功
[2025-10-10 13:42:45] [INFO] [main:61]   - 内容长度: 46822 字符
[2025-10-10 13:42:45] [INFO] [main:62]   - API 调用次数: 1
[2025-10-10 13:42:45] [INFO] [main:63]   - 总耗时: 431477 毫秒 (431.48 秒)
[2025-10-10 13:42:45] [INFO] [main:70]   - 原始响应已保存到: test_mode/PRED-726-corrected-raw.txt
[2025-10-10 13:42:45] [WARNING] [main:93] 响应不是JSON格式，将整个响应视为SRT内容
[2025-10-10 13:42:45] [INFO] [main:101]   - 校正结果已保存到: test_mode/PRED-726-uncensored-nyap2p.com.corrected.srt
[2025-10-10 13:42:45] [INFO] [main:107]   - 改动记录已保存到: test_mode/PRED-726-corrected-differences.json
[2025-10-10 13:42:45] [INFO] [main:108]   - 关键改动数量: 7
[2025-10-10 13:42:45] [INFO] [main:120] ================================================================================
[2025-10-10 13:42:45] [INFO] [main:121] 开始字幕翻译...
[2025-10-10 13:42:45] [INFO] [main:122] ================================================================================
[2025-10-10 13:42:45] [INFO] [strategies:205] Processing node with 1044 subtitles
[2025-10-10 13:42:45] [INFO] [provider:42] OpenAIProvider chat called for model: google/gemini-2.5-pro
[2025-10-10 13:42:45] [INFO] [provider:61] Sending request to API (attempt 1/5, non-streaming mode)...
