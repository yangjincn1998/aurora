# config.yml

# 全局设置，可被任务级设置覆盖
global_settings:
  # API 重试策略
  retry_policy:
    max_retries: 5
    retry_delay_seconds: 8
  # API 请求超时
  api_timeout_seconds: 500

# 定义所有任务
tasks:
  # 元数据翻译任务（这是一个示例，您可以为每个元数据任务单独配置）
  translate_metadata:
    providers:
      - service: openai  # 使用哪个 Provider 类
        model: "deepseek/deepseek-chat-v3.1:free"
        api_key_env: "DEEPSEEK_API_KEY" # 从哪个环境变量读取 key
        base_url: "https://api.deepseek.com/v1"

  # 字幕校正任务
  correct_subtitle:
    strategy:
      type: slice # 策略类型: slice, no_slice
      args:
        max_slice_size: 600
        min_split_lines: 10 # 当失败的块行数 >= 此值时，才进行三等分

    providers:
      # Provider 列表，会按顺序尝试 (责任链模式)
      - service: openai
        model: "google/gemini-2.5-pro"
        api_key_env: "OPENROUTER_API_KEY"
        base_url_env: "OPENROUTER_BASE_URL"
        timeout: 800 # 可以覆盖全局的 api_timeout_seconds

  # 字幕翻译任务
  translate_subtitle:
    strategy:
      type: slice
      args:
        max_slice_size: 500
        min_split_lines: 10

    providers:
      - service: openai
        model: "anthropic/claude-3-sonnet"
        api_key_env: "OPENROUTER_API_KEY"
        base_url_env: "OPENROUTER_BASE_URL"
        # 未指定 timeout，将使用全局设置 (500s)